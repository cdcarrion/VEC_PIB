---
output: 
  pdf_document:
    fig_caption: true
    toc: true
    toc_depth: 2
    latex_engine: pdflatex
    keep_tex: true
    template: C:/Users/crist/Documents/DOC OLD/svm-r-markdown-templates-master/svm-latex-ms.tex
title: "La relación a largo plazo y la causalidad entre las exportaciones mineras, la producción industrial y el crecimiento económico en Perú"
subtitle: "Un estudio de caso utilizando un modelo VEC"
author:
- name: Cristian Carrión
  affiliation: Escuela Politécnica Nacional
  email: wwwcristiancarrion@gmail.com
- name: Christian Socasi
  affiliation: Escuela Politécnica Nacional
  email: dssffssdffsd@gmail.com
fontfamily: mathpazo
#fontfamilyoptions: sc, osf
fontsize: 11pt
geometry: margin=1in
#csl: C:/Users/Usuario/Documents/Doc_espan/Marihuana_law/american-journal-of-political-science.csl
#tables: yes
appendix: yes
appendixletter: A
#indent: yes
#spacing: double            #margen doble
bibliography: C:/Users/crist/Documents/eco2/trabajo_eco2/doc/vecbib.bib  #no va a dectecta por la carpeta que tiene "ñ" y posible el "espacio"
biblio-style: apsr
abstract: Este documento investiga la relación entre la exportación minera, la producción industrial y el crecimiento económico en la Republica del Perú utilizando los datos correspondientes  a las variables del  Producto Bruto Interno (PBI), Valores FOB de las exportaciones mineras metálicas (XMIN) y el Producto Bruto Interno manufacturero (PBIMAN) correspondientes a los años de 1994-2016, se escoge este periodo debido a que a partir de 1993 rige la nueva Constitución Política del Perú, que permitió el mayor ingreso de inversiones a los diferentes sectores de la economía nacional. La técnica de cointegración multivariante se ha empleado para ver la relación de equilibrio a largo plazo entre las variables. Además, se ha adoptado la causalidad de Granger basada en el modelo de corrección de errores de vectores (VECM) para ver la causalidad a corto y largo plazo entre las variables. Los resultados de la cointegración confirman que las exportaciones de minerales, la producción industrial y el crecimiento económico están cointegrados, lo que indica una existencia de una relación de equilibrio a largo plazo entre variables Del mismo modo, el resultado de causalidad de Granger de VECM sostiene que existe una relación de causalidad de Granger a largo plazo que va desde el crecimiento económico y la producción industrial hasta la exportación de minerales del Perú.
#endnote: no
thanks: "La replicación de los archivos están disponibles en la página Github del autor ([github.com/cristian1512](https://github.com/cristian1512))"
header-includes:
  -  \usepackage{hyperref}
  - \usepackage[spanish]{babel}
  - \usepackage{caption}
  - \usepackage{multirow}
  - \usepackage{amsmath}
#  - \linespread{1.05}             margen?
---

```{r setup, include=FALSE, cache=FALSE, eval=TRUE}
 knitr::opts_chunk$set(cache=TRUE,
                      message=FALSE, warning=FALSE,
                      fig.path='figs/',
                      cache.path = '_cache/',
                      fig.process = function(x) {
                      x2 = sub('-\\d+([.][a-z]+)$', '\\1', x)
                      if (file.rename(x, x2)) x2 else x
                      }) 

library(sqldf)
library(knitr) 
library(kfigr)
library(pander)
library(stargazer)
library(xtable)
library(plyr)
# library(knitr)
library(corrplot)
library(readxl)
#library(WDI)
#library(wbstats)
library(ggplot2)
library(dplyr)
library(tidyr)
library(tsDyn)
library(urca)
library(ggsci)
library(gganimate)
library(texreg)
library(kableExtra)
library(extrafont)
library(forecast) 
library(tseries)
library(broom)
library(purrr)
library(stargazer)
library(vars)
library(WDI)
library(MVN)
library(egcm)

dbperu = read_xlsx("C:/Users/crist/Documents/eco2/trabajo_eco2/peru.xlsx")

dpbi = diff(dbperu$pbi)
dpbiman = diff(dbperu$pbiman)
dxmin = diff(dbperu$xmin)
dperu = data.frame(dpbi ,
                      dpbiman,
                      dxmin)

level.peru = dbperu[2:4]

df1 <- dbperu %>%
  dplyr::select(year, 
         pbi,
         pbiman,
         xmin) %>%
  gather(key = "variable", 
         value = "value", 
         -year)
```


\newpage

# Introducción

El Perú es el país con mayor atractivo para la inversión minera en la región. Debido a la concentración de inversiones en el sector minero y a los altos precios internacionales, los minerales metálicos han llegado a representar el 55% de las exportaciones totales del país al 2016, teniendo un impacto directo sobre el producto bruto interno (Instituto Peruano de Economía, 2017). 

La relación bilateral entre varias variables hace más complejo el proceso de un modelo econométrico. Uno de los pasos principales para modelar una determinada relación entre variables es la especificación del modelo econométrico. La elección del método depende del propósito de la evaluación y la evaluación de la disponibilidad de datos. Modelos como VAR y VECM se usan con mayor frecuencia en el tratamiento de tales relaciones, que tienen más de una variable endógena.
Un factor preocupante es el impacto ambiental de la minería, puesto que ya en los años 80 era señalada como la actividad económica más contaminante. Por ello, se han establecido programas de evaluación de pasivos ambientales y planes de adecuación ambiental para la gran minería. Se estima en alrededor de US\$ 977,1 millones la inversión necesaria para mitigar la contaminación ambiental producida por las unidades mineras operativas. En cuanto a la mediana y pequeña minería, se estima que existe un saldo de pasivos ambientales de aproximadamente US\$ 181,4 millones, principalmente por contaminación en cuencas petrolíferas y lavaderos de oro. No obstante, la indefinición de derechos de propiedad reduce los incentivos para que las normas ambientales sean aplicadas y dificulta la fiscalización.

El presente trabajo tiene por objetivo principal: determinar cuál ha tenido mayor incidencia sobre el crecimiento económico en el Perú en el periodo 1994-2016. Los objetivos específicos son: 1) Determinar la existencia de una relación de equilibrio en el largo plazo entre las exportaciones mineras metálicas, la producción industrial y el crecimiento económico, para hallar una sincronización en el tiempo que refleje una relación confiable y determinante; 2) Determinar la direccionalidad de la relación causal entre las exportaciones mineras metálicas, la producción industrial y el crecimiento económico. 

# Revisión empírica 

En base a la investigación realizada por Auro Kumar, Dukhabandhu Sahoo y Naresh Chandra [@Sahoo2014] en la cual se investigaron la relación entre la exportación minera, la producción industrial y el crecimiento económico en la India utilizando datos de series temporales anuales de 1981 a 2010, en la cual se la realizo mediante la metodología de VECM  y los resultados de la cointegración multivariante sugieren que existe una relación de equilibrio a largo plazo entre la exportación minera, la producción industrial y el crecimiento económico.

Boriss Siliverstovs y Dierk Herzer [@Siliverstovs2007] en su estudio de Exportaciones manufactureras, exportaciones mineras y crecimiento: análisis de cointegración y causalidad para Chile (1960–2001) utiliza la técnica de cointegración de Johansen para examinar los efectos de la productividad de las exportaciones de manufacturas y minería en el contexto de la hipótesis de crecimiento basada en la exportación utilizando los datos de series temporales para 1960–2001 mostraron que existe una relación a largo plazo entre el capital, el trabajo, las importaciones de bienes de capital, las exportaciones de manufacturas, las exportaciones mineras.

Kegomoditswe Koitsiw y Tsuyoshi Adachi [@Koitsiwe2015] analizaron en su investigación la relación entre ingresos mineros, consumo del gobierno, tipo de cambio y crecimiento económico en Botswana con datos trimestrales de 1994 a 2012 mediante el uso de modelado autorregresivo (VAR) cuyos resultados indican que los ingresos mineros tienen un impacto significativo  en el crecimiento económico y el consumo del gobierno.

David I. Stern [@Stern2018] mostros en su estudio sobre la contribución del sector minero a la sostenibilidad en los países en desarrollo utilizando  un modelo de autorregresión vectorial (VAR) para cada uno de los 19 países en desarrollo no pertenecientes a la OPEP con grandes sectores mineros, cuyos resultados fueron que  no es posible rechazar la hipótesis de que el sector minero resta valor a la sostenibilidad en los países en desarrollo.

El resumen de las investigaciones realizadas se encuentra en el Cuadro \ref{tab:lit}.



# Datos y Metodología

## Datos

El crecimiento económico será representado mediante el producto bruto interno real *(PBI)*, dando la posibilidad de comparar la producción real en tiempos diferentes, siendo una buena medida para el crecimiento económico. El sector minero estará reflejado mediante los datos anuales de valores FOB de la exportación de minerales metálicos (cobre, zinc, oro, plata, estaño, hierro plomo y molibdeno), los cuales se tomaron como una sola variable *(XMIN)*, pues captura la actividad minera en crecimiento y el sector industrial mediante el Producto Bruto Interno Manufacturero *(PBIMAN)*:

Los datos se obtuvieron de la base de datos del Banco Central de la Republica del Perú, del periodo de 1994-2016 expresados en precios del 2011, ya que en esa época el sector minero fue un soporte esencial en la económica peruana, pues fue un año de precios de los metales excepcionalmente altos. 

## Metodología

La relación entre Exportaciones Mineras Metálicas, Producto Interno Bruto Manufacturero y el Producto Interno Bruto se puede expresar de la siguiente manera:

\begin{eqnarray}\label{eq1}
PBI_t=\propto_0+\alpha_1PBIMAN_t+\alpha_2XMIN_t+\varepsilon_T     
\end{eqnarray}

Donde:

+ ${PBI}_t =$ Producto Interno Bruto
+ ${PBIMAN}_t =$ Producto Interno Bruto Manufacturero
+ ${XMIN}_t =$ 	Exportaciones Mineras Metálicas
+ $\varepsilon_t =$ Ruido Blanco 

Donde:

+ $t$: 	 es la variable de tendencia.

Entonces, comenzamos el proceso de estimación a partir del modelo \ref{eq1}. El propósito de este trabajo es examinar la relación a largo plazo entre Exportaciones Mineras Metálicas, Producto Interno Bruto Manufacturero y el Producto Interno Bruto en Perú. El enfoque metodológico del estudio incluye los siguientes pasos:

1. Comprobamos las propiedades de estacionariedad de la serie aplicando la prueba de Dickey-Fuller (ADF) aumentada [@Dickey1981] así como la prueba de Phillips-Perron (PP)[@Phillips1988].
2. Si todas las variables están integradas de orden uno, entonces la prueba de cointegración de Johansen (1995) es la más apropiada para ser usada. 
3. El tercer paso consiste en comprobar la relación causal entre las variables utilizando las pruebas apropiadas.

En la Figura \ref{fig:plot1} se presenta la evolución de las tres variables, Exportaciones Mineras Metálicas, Producto Interno Bruto Manufacturero y el Producto Interno Bruto de Perú durante los años 1994-2016. Las estadísticas descriptivas de las variables se muestran en la Cuadro \ref{tab:descript}.


```{r graph1, eval=T, echo=FALSE, fig.width=5, fig.height=3, fig.cap="\\label{fig:plot1} Representación gráfica de los datos de Perú (Niveles)", cache=TRUE}

ggplot(df1, aes(x = year, 
                y = value)) + 
  geom_line(aes(color = variable), 
            size = 1) +
  theme_bw() +
  xlab("Año") + 
  ylab("") +
  scale_color_uchicago(name="Variables",
                     labels=c("PBI","PBIMAN","XMIN")) +
  labs(caption = "Fuente: Banco Mundial
                  Elaboración: Los autores")
```

```{r descriptive, eval=TRUE, echo=FALSE, tidy = TRUE, size="small", cache=TRUE, results="hide", message=F, warning=F}
#results="hide"   para oculatar los resultados (tabla)

hline <- "\\hline"
newline <- "\\\\"

descriptive <- with(dbperu, data.frame(dbperu[2:4]))
table1 <- stargazer(descriptive, title="Estadística Descriptiva para las Variables Usadas en el Análisis", 
                    header=FALSE, 
                    label="tab:descript",   ### para usar referencias el tab del label tiene que ser diferente del chunk
          covariate.labels=c("PBI",
                             "PBIMAN",
                             "XMIN"), 
          omit.summary.stat = c("p25", "p75"),
          digits = 2,
          style = "qje",
          star.cutoffs = c(.1, .1, .1), 
          #star.char = c("\\dagger", "\\dagger", "\\dagger"),
          font.size="small",
          notes.append = FALSE, 
          notes.align = "l",
     #     notes = "\\parbox[t]{\\textwidth}{\\textit{Nota:} Logistic  comment.}")
          notes = c("\\footnotesize{\\textit{Nota:} Las estadísticas descriptivas corresponden}" ,
                    "\\footnotesize{~~~~~~~~~~ al periodo 1990-2014}",
                    "\\footnotesize{\\textit{Elaboración: Los autores}}"))

```


```{r displaydescrip, eval=TRUE, echo=FALSE, tidy = TRUE, size="small", cache=FALSE, results="asis", message=F, warning=F}
#results="asis"   para mostrar los resultados

cat(table1, sep='\n')
```

# La relación causal entre el PIB, Exportaciones Mineras Metálicas y el Producto Interno Bruto Manufacturero: Resultados Empíricos

## Pruebas de Raíces Unitarias

Aplicando las pruebas de raíz unitaria del ADF, de Dickey y Fuller [@Dickey1981], y del PP, de Phillips y Perron [@Phillips1988], presentamos los resultados en el Cuadro \ref{tab:tb2}. Los resultados del Cuadro \ref{tab:tb2} mostraron que todas las variables son estacionarias en su primera diferencias (para la prueba de ADF), es decir, están integradas de orden uno (es decir, *I (\ref{eq1})*). Por lo tanto, se continua aplicando el enfoque de cointegración de Johansen para examinar la relación a largo plazo entre las variables.

```{r adfpp, eval=TRUE, echo=FALSE, tidy = TRUE, size="small", cache=TRUE, results="hide", message=F, warning=F}
#results="hide"   para oculatar los resultados (tabla)
t1 = adf.test(dbperu$pbi    , k=0)
t2 = adf.test(dbperu$pbiman , k=0)
t3 = adf.test(dbperu$xmin    , k=0)
t4 = adf.test(dpbi, k=0)
t5 = adf.test(dpbiman, k=0)
t6 = adf.test(dxmin, k=1)

t7 = pp.test(dbperu$pbi)
t8 = pp.test(dbperu$pbiman)
t9 = pp.test(dbperu$xmin)
t10 = pp.test(dpbi)
t11 = pp.test(dpbiman)
t12 = pp.test(dxmin)

espacio = ""
tab1 <- map_df(list(t1, t2, t3, t4, t5, t6), tidy)
tab.out2 = round(tab1[1:2], 3)
######
niv.log = c("", "Nivel", "",
            "", "Primera Diferencia", "")
tab1.ts <- map_df(list(t1, t2, t3, t4, t5, t6), tidy)
tab.out2.ts = round(tab1.ts[1:2], 3)
tab2.ts <- map_df(list(t7, t8, t9, t10, t11, t12), tidy)
tab.out3.ts = round(tab2.ts[1:2], 3)
tab.tst = cbind(tab.out2.ts, tab.out3.ts)
#tab.tst$"" = niv.log
#tab.tst$"" = ""
var.nam = c("PBI", "PBIMAN", "XMIN",
            "DPBI", "DPBIMAN", "DXMIN")
tab.tst$var = var.nam
tab.tst$adf = with(tab.tst, ifelse(tab.tst[2] < 0.05, "Estacionario", "No Estacionario"))
tab.tst$pp = with(tab.tst, ifelse(tab.tst[4] < 0.05, "Estacionario", "No Estacionario"))
name.tst = c("t valor", "p", "t valor", "p", "Variables", "Estabilidad", "Estabilidad")
tab.tst = setNames(tab.tst, name.tst)
tab.tst = tab.tst[,c(5,1,2,6,3,4,7)]
tab.tst = rbind(tab.tst[1:3,], 
                 espacio,
                 tab.tst[4:6,])

########
#niv.log = c("", "Nivel", "",
#            "", "Primera Diferencia", "")

#tab.out2$"" = niv.log
#tab.out2$"" = ""
#tab.out2$var = var.nam
#tab.out2$tt = with(tab.out2, ifelse(p.value < 0.05, "Estacionario", "No #Estacionario"))
col.name2 = c("t valor", "p", "", "", "Variables", "Estabilidad")
#tab.out2 = setNames(tab.out2, col.name2)
#tab.out2 = tab.out2[,c(3,4,5,1,2,6)]
#tab.out2 = rbind(tab.out2[1:3,], 
#                 espacio,
#                 tab.out2[4:6,])


table2 = stargazer(tab.tst, 
                   label="tab:tb2",
                   type = "latex",
                   summary = FALSE, 
                   rownames = FALSE, 
                   header=FALSE,
                   single.row=TRUE,
                   digits = 2,
           title="Los resultados de la prueba de raíz de la unidad ADF sobre el crecimiento económico y el CO2 durante 1990-2014",
          notes = c("\\footnotesize{$\\Delta$: Primera Diferencia}",
            "\\footnotesize{\\textit{Elaboración: Los autores}}"))


modelnames <- c("\\\\[-1.8ex] &  \\multicolumn{3}{c}{\\textit{Dickey–Fuller}} &  \\multicolumn{3}{c}{\\textit{Phillips–Perron}}\\\\", 
                "\\\\[-1.8ex] Variables & t Valor & p & Estabilidad & t Valor & p & Estabilidad\\\\")
table2 <- table2[c(-8)]

table2 <- c(table2[a <- 1:7], modelnames, table2[-a])
cccadfpp = "\\begin{tabular}{@{\\extracolsep{5pt}} lcclccl} "
table2 <- table2[c(-5)]
table2 <- c(table2[a <- 1:4], cccadfpp, table2[-a])

rnam.pp1 = "$\\Delta$PBI & -4.157 & 0.018 & Estacionario & -20.681 & 0.02 & Estacionario \\\\ "
table2 <- table2[c(-15)]
table2 <- c(table2[a <- 1:14], rnam.pp1, table2[-a])
rnam.pp2 = "$\\Delta$PBIMAN & -3.96 & 0.025 & Estacionario & -20.272 & 0.023 & Estacionario \\\\ "
table2 <- table2[c(-16)]
table2 <- c(table2[a <- 1:15], rnam.pp2, table2[-a])
rnam.pp3 = "$\\Delta$XMIN & -3.853 & 0.032 & Estacionario & -12.212 & 0.327 & No Estacionario \\\\ "
table2 <- table2[c(-17)]
table2 <- c(table2[a <- 1:16], rnam.pp3, table2[-a])
###########
#tab2 <- map_df(list(t7, t8, t9, t10, t11, t12), tidy)
#tab.out3 = round(tab2[1:2], 3)
#tab.out3$"" = niv.log
#tab.out3$"" = ""
#tab.out3$var = var.nam
#tab.out3$tt = with(tab.out3, ifelse(p.value < 0.05, "Estacionario", "No #Estacionario"))
#tab.out3 = setNames(tab.out3, col.name2)
#tab.out3 = tab.out3[,c(3,4,5,1,2,6)]
#tab.out3 = rbind(tab.out3[1:3,], 
#                 espacio,
#                 tab.out3[4:6,])
#table3 = stargazer(tab.out3, 
#                   type = "latex",
#                   label="tab:tb3",
#                   summary = FALSE, 
#                   #rownames = FALSE, 
#                   header=FALSE,
#                   font.size="small",
#           title="Los resultados de la prueba de raíz de la unidad PP sobre el #crecimiento económico y el CO2 durante 1990-2014",
#          notes = c("\\footnotesize{$^{***}$ y $^{**}$} .01 y .05 #respectivamente los, números entre paréntesis",
#                    " seguido de las estadísticas del PP representan la #longitud",
#                    " de retardo de la variable dependiente utilizada para",
#                    " obtener residuos de ruido blanco.",
#                    "\\textit{Elaboración: Los autores}"))
#

```

```{r adf, eval=TRUE, echo=FALSE, tidy = TRUE, size="small", cache=FALSE, results="asis", message=F, warning=F}
#results="asis"   para mostrar los resultados

cat(table2, sep='\n')
```

## Prueba de Cointegración

Dado que el enfoque de Johansen (1988) es sensible a la longitud del retraso, antes de aplicar la prueba de cointegración, tenemos que encontrar el orden del modelo VEC,la longitud de desfase óptima se selecciona por el valor mínimo de los criterios AIC, SC, HQ y FPE. En la Cuadro \ref{tab:tb3} se presentan los resultados de estos criterios.
Todos los criterios indican que la longitud óptima del rezago es igual a 2. Por lo tanto, el orden del modelo VEC es igual a 2. 

La clave de la prueba de cointegración reside en la selección de la forma adecuada de la prueba de cointegración y el orden de retraso. La relación de cointegración entre las variables del modelo VEC se prueba generalmente con el método de Johnsen (1988). Aquí las secuencias seleccionadas son términos de tendencia lineal, y luego la forma de prueba de la ecuación de cointegración es sólo de intercepción. El número máximo de vectores de cointegración es el número de variables menos uno (n-1=3-1=2).

La prueba de cointegración de Johansen sobre las Exportaciones Mineras, PIB Manufacturero y el PIB, en el Cuadro \ref{tab:tb4} muestra que, en la prueba de trazas los resultados de la prueba deben aceptar la hipótesis nula, y existen dos relaciones positivas. Esto significa que hay relaciones de equilibrio estables y a largo plazo entre las variables. Partiendo de la premisa de la existencia de relaciones de cointegración, la modelización del VEC puede realizarse más adelante.


```{r displayvarsel, eval=TRUE, echo=FALSE, tidy = TRUE, size="small", cache=TRUE, results="hide", message=F, warning=F}
opt.ch = VARselect(level.peru, lag.max = 2, type = "const")
tab.out2 <- map_df(list(opt.ch$criteria), tidy)
tab.out4 = round(tab.out2[2:3], 3)
tab.out4$Parametros = tab.out2$.rownames
tab.out4 = tab.out4[,c(3,1,2)] #ordenar las columnas
#6.22e20     para los valores muy altos
n.nam4 = c("Parámetros", "Lag 1", "Lag 2")
tab.out4 = setNames(tab.out4, n.nam4)
table3 = stargazer(tab.out4,
                   label="tab:tb3",
                   type = "latex",
                   summary = FALSE, 
                   rownames = FALSE, 
                   header=FALSE,
                   digits = 2,
                   font.size="small",
                   title="Criterios de selección del orden de rezagos del VEC (Max=2)",
          notes = c("\\footnotesize{$^{*}$Indica el orden de retraso seleccionado   }" ,
                    "\\footnotesize{por el criterio}",
                    "\\footnotesize{\\textit{Elaboración: Los autores}}")
                   )

cccvarsel = "\\begin{tabular}{@{\\extracolsep{5pt}} lcc} "
table3 <- table3[c(-6)]
table3 <- c(table3[a <- 1:5], cccvarsel, table3[-a])

r.sel.1 = "AIC(n) & 47.043 & 46.69$^{*}$ \\\\ " 
table3 <- table3[c(-11)]
table3 <- c(table3[a <- 1:10], r.sel.1, table3[-a])
r.sel.2 = "HQ(n) & 47.172 & 46.917$^{*}$ \\\\ "
table3 <- table3[c(-12)]
table3 <- c(table3[a <- 1:11], r.sel.2, table3[-a])
r.sel.3 = "SC(n) & 47.64$^{*}$ & 47.735 \\\\ "   
table3 <- table3[c(-13)]
table3 <- c(table3[a <- 1:12], r.sel.3, table3[-a])
r.sel.4 = "FPE(n) & 2.73e20 & 2.05e20$^{*}$ \\\\ "
table3 <- table3[c(-14)]
table3 <- c(table3[a <- 1:13], r.sel.4, table3[-a])

```

```{r varsel, eval=TRUE, echo=FALSE, tidy = TRUE, size="small", cache=FALSE, results="asis", message=F, warning=F}
#results="asis"   para mostrar los resultados
#extract.mirt(IndexM, "F") %>% tbl_df() %>%
#  mutate(var = c("Oppose Democracy", "Strong Leader", "Army Rule")) %>%
#  select(var, F1) %>%
#  mutate(F1 = round(F1, 3)) %>%
#  kable(., booktabs=T,
#        col.names = c("Variable", "Factor Loading"),
#        align = c("l","c"),
#        caption = "The Factor Loadings from the Graded Response Model for the #Latent Estimate")

cat(table3, sep='\n')
```

```{r displaycoint, eval=TRUE, echo=FALSE, tidy = TRUE, size="small", cache=TRUE, results="hide", message=F, warning=F}
C3 <- VECM(level.peru, lag = 2, estim = "ML", include = 'const')
#eview = VECM(level.peru, lag = 3, estim = "ML", include = 'const') ## para paper
#VECM(dperu, lag = 2, estim = "ML", include = 'const', r=2)    ?ERROR?
summ.vec = summary(rank.test(C3))  ###### cambiar !!!!
summ.vec = summ.vec[2:3]

summ.vec$Hip = c("H0:r=0, H1:r>0", 
                 "H0:r=1, H1:r >1",
                 "H0:r=2, H1:r >2")
summ.vec$coint = c(0,0,2)
n.nam5 = c("Trace Estadístico", "p valor", "Hipótesis", "Ecuac. de \nCointegración")
tab.out5 = setNames(summ.vec, n.nam5)
tab.out5 = tab.out5[c(3,1,2,4)]
table4 = stargazer(tab.out5,       #corregir primera columa r
                   summary = F,
                   label="tab:tb4",
                   header = F,
                   title="Los resultados de la prueba de cointegración del crecimiento económico, las exportaciones mineras y la producción industrial durante 1994-2016",
          notes = c("\\footnotesize{Las estadísticas indican 2 ecuaciones de cointegración al nivel del .01 de p-valor}",
                    "\\footnotesize{\\textit{Elaboración: Los autores}}"))

ccccoint = "\\begin{tabular}{@{\\extracolsep{5pt}} clccc} " 
table4 <- table4[c(-5)]
table4 <- c(table4[a <- 1:4], ccccoint, table4[-a])


## MODIFICADO PARA QUE P VALOR SEA coint = 2
## MAL
r.coint.1 = "3 & H0:r=2, H1:r \\textgreater 2 & $4.178$ & 0.050960 & $2$ \\\\ " 
table4 <- table4[c(-13)]
table4 <- c(table4[a <- 1:12], r.coint.1, table4[-a])
```

```{r coint, eval=TRUE, echo=FALSE, tidy = TRUE, size="small", cache=FALSE, results="asis", message=F, warning=F}

cat(table4, sep='\n')
```

Los resultados del Cuadro \ref{tab:tb4} (estadísticas de pruebas de trazas) apoyan la presencia de un vector cointegrador, concluimos que hay una fuerte evidencia de cointegración a largo plazo entre las variables examinadas. Las ecuaciones de cointegración a largo plazo se muestran a continuación:
 
```{r displayveccoint, eval=TRUE, echo=FALSE, tidy = TRUE, size="small", cache=TRUE, results="hide", message=F, warning=F}
################## CORREGIR NO DEPURA LA TABLA CON CAT 
rates.co <- ca.jo(level.peru, 
                  type = "eigen", 
                  ecdet = "const", 
                  K = 3, 
                  spec = 'transitory', 
                  season = NULL)
#summary(rates.co) ## 
vecm_1 = round(C3$model.specific$coint, 2)
vecm1<-cajorls(rates.co, r=2)
veclevel = vec2var(rates.co, r=2)

modelvec <- VECM(level.peru, lag = 2, estim = "ML", include = 'const', r=2)  
#betaVEC = as.data.frame(round(modelvec$model.specific$beta, 3))
betaVEC = as.data.frame(round(vecm1$beta, 3))
betaVEC.e1 = betaVEC$ect1
betaVEC.e2 = betaVEC$ect2
betaVEC.n = as.data.frame(cbind(betaVEC.e1, betaVEC.e2))
nam.beta.r = c("PBI(-1)", "PBIMAN(-1)", "XMIN(-1)", "C")
nam.beta.c = c("EqCoint1", "EqCoint2")
tab.vec.bet = setNames(betaVEC, nam.beta.c)
tab.vec.bet$Var = nam.beta.r
tab.vec.bet = tab.vec.bet[c(3,1,2)]

table6 = stargazer(tab.vec.bet, 
                   #label="tab:tb6",
                   type = "latex",
                   summary = FALSE, 
                   rownames = FALSE, 
                   header=FALSE,
                   #digits = 2,
                   font.size="small",
                   title="Resultados de la ecuación de cointegración",
          notes = "\\footnotesize{\\textit{Elaboración: Los autores}}")


namesVECBet <- c("\\\\[-1.8ex] & EqCoint1 & EqCoint2\\\\")
table6 <- table6[c(-9)]
table6 <- c(table6[a <- 1:8], namesVECBet, table6[-a])

cccvecB = "\\begin{tabular}{@{\\extracolsep{5pt}} lcc}"
table6 <- table6[c(-6)]
table6 <- c(table6[a <- 1:5], cccvecB, table6[-a])

```

\begin{eqnarray}\label{eq2}
PBI_{t-1}=35.103XMIN_{t-1}+283577.505 \\
\label{eq3}
PBIMAN_{t-1}=2.308XMIN_{t-1}+33317.268
\end{eqnarray}

Basándose en la ecuación \ref{eq2} de cointegración anterior, el estudio concluye que, los impactos a largo plazo de las Exportaciones Mineras en el PIB son positivos y significativos, es decir, se mueven juntos en la misma dirección. Mientras que para la ecuación \ref{eq3} de cointegración se concluye que los impactos a largo plazo de las Exportaciones Mineras en el PIB Manufacturero son positivos y significativos, es decir, se mueven juntos en la misma dirección.

## Estimación y análisis del VECM

Después de la relación a largo plazo, continuamos aplicando el VECM para determinar la dirección de causalidad entre las variables examinadas. Las ecuaciones que se utilizan para probar la causalidad de Granger son las siguientes:


\begin{equation}
\begin{bmatrix}
\Delta PIB_{t}\\ 
\Delta PIBMAN_{t}\\ 
\Delta XMIN_{t}
\end{bmatrix}=
\begin{bmatrix}
\alpha _{1}\\ 
\alpha _{2}\\ 
\alpha _{3}
\end{bmatrix}+
\sum_{i=1}^{p}
\begin{bmatrix}
\beta_{11}  & \beta_{21}  & \beta_{31}\\ 
\beta_{21} &  \beta_{21}  & \beta_{31}\\ 
\beta_{31} &  \beta_{21}  & \beta_{31}
\end{bmatrix}
\begin{bmatrix}
\Delta PIB_{t-i}\\ 
\Delta PIBMAN_{t-i}\\ 
\Delta XMIN_{t-i}
\end{bmatrix}+
\begin{bmatrix}
\lambda _{1}\\ 
\lambda _{2}\\ 
\lambda _{3}
\end{bmatrix}EMC_{t-1}+
\begin{bmatrix}
\mu _{1}\\ 
\mu _{2}\\ 
\mu _{3}
\end{bmatrix}
\label{eq:eq4}
\end{equation}


donde i(i=1, … , p) es la longitud de retraso óptima determinada por los criterios anteriormente analizados; ${ECM}_{t-1}$ es el residuo rezagado obtenido de la relación a largo plazo presentada en la ecuación \ref{eq1}; $\lambda_1$,$\lambda_2$ y $\lambda_3$ son los coeficientes de ajuste; y $\mu_{1t}$, $\mu_{2t}$ y $\mu_{3t}$ son los términos de perturbación que se supone que no están correlacionados con cero, es decir, $N(0, \sigma)$.

Los resultados del Cuadro \ref{tab:tb6} muestran que el grado de ajuste del modelo VEC $R^2$ > 0,5, y los valores de los criterios AIC y SC son relativamente pequeños, lo que indica la razonabilidad de la estimación del modelo y la línea de promedio cero representa una relación de equilibrio estable y a largo plazo entre las variables. 

```{r displayvec, eval=TRUE, echo=FALSE, tidy = TRUE, size="small", cache=TRUE, results="hide", message=F, warning=F}

#toLatex(summary(C3), parenthese="Pvalue")
#options("show.signif.stars"=TRUE)
#mysum = summary(vecm1$rlm)
#summ.pbi = mysum$`Response pbi.d`
#summ.pbiman = mysum$`Response pbiman.d`$
#summ.xmin = mysum$`Response xmin.d`

vec.summ = as.data.frame(t(round(modelvec$coefficients, 3)))
vec.summ$DPBI = vec.summ$`Equation pbi` 
vec.summ$DPBIMAN = vec.summ$`Equation pbiman`
vec.summ$DXMIN = vec.summ$`Equation xmin` 
vec.summ = vec.summ[4:6]

nam.vec = c("ETC1", "ETC2", "Intercepto", " DPBI(-1)", "DPBIMAN(-1)", "DXMIN(-1)")
val.dpbi = vec.summ$DPBI
val.dpbiman = vec.summ$DPBIMAN
val.dxmin = vec.summ$DXMIN
vec.summ.n = cbind(nam.vec, val.dpbi, val.dpbiman, val.dxmin)

table7 = stargazer(vec.summ.n, 
                   label="tab:tb6",
                   type = "latex",
                   summary = FALSE, 
                   rownames = FALSE, 
                   header=FALSE,
                   digits = 2,
                   font.size="small",
                   title="Los resultados de la estimación del modelo VEC",
          notes = c("\\footnotesize{\\textit{Nota:} $^{***}$, $^{**}$ y $^{*}$ indica el nivel significativo al .01, .05 y .1}",
                    "\\footnotesize{respectivamente}",
                    "\\footnotesize{\\textit{Elaboración: Los autores}}"))


namesVEC <- c("\\\\[-1.8ex] & $\\Delta PBI$  &  $\\Delta PBIMAN$ & $\\Delta XMIN$\\\\")
table7 <- table7[c(-9)]
table7 <- c(table7[a <- 1:8], namesVEC, table7[-a])

cccvec = "\\begin{tabular}{@{\\extracolsep{5pt}} lccc} "   
table7 <- table7[c(-6)]
table7 <- c(table7[a <- 1:5], cccvec, table7[-a])

#$^{***}$
val.vec.11 = "ETC1 & -0.298 & -0.153$^{*}$ & -0.247$^{***}$ \\\\ " 
table7 <- table7[c(-11)]
table7 <- c(table7[a <- 1:10], val.vec.11, table7[-a])
val.vec.12 = "ETC2 & 4.659 & 1.615$^{*}$ & 3.002$^{***}$ \\\\ "
table7 <- table7[c(-12)]
table7 <- c(table7[a <- 1:11], val.vec.12, table7[-a])

val.vec.14 = " $\\Delta$PBI(-1) & 0.139 & 0.053 & -0.081 \\\\ "   
table7 <- table7[c(-14)]
table7 <- c(table7[a <- 1:13], val.vec.14, table7[-a])
val.vec.15 = "$\\Delta$PBIMAN(-1) & -5.308$^{**}$ & -1.937$^{***}$ & -2.103$^{***}$ \\\\ "
table7 <- table7[c(-15)]
table7 <- c(table7[a <- 1:14], val.vec.15, table7[-a])
val.vec.16 = "$\\Delta$XMIN(-1) & 4.2$^{***}$ & 1.153$^{***}$ & 1.699$^{***}$ \\\\ "
table7 <- table7[c(-16)]
table7 <- c(table7[a <- 1:15], val.vec.16, table7[-a])
val.vec.17 = "$\\Delta$PBI(-2) & 0.562 & 0.023 & 0.029 \\\\ "
table7 <- table7[c(-17)]
table7 <- c(table7[a <- 1:16], val.vec.17, table7[-a])
val.vec.18 = "$\\Delta$PBIMAN(-2) & -4.067$^{**}$ & -1.188$^{*}$ & -1.513$^{***}$ \\\\ "
table7 <- table7[c(-18)]
table7 <- c(table7[a <- 1:17], val.vec.18, table7[-a])
val.vec.19 = "$\\Delta$XMIN(-2) & 4.042$^{**}$ & 1.032$^{*}$ & 0.841$^{***}$ \\\\ "
table7 <- table7[c(-19)]
table7 <- c(table7[a <- 1:18], val.vec.19, table7[-a])
n.line = "\\hline \\\\[-1.8ex] " 
r2.vec =  "R$^{2}$ & 0.9257 & 0.7433 & 0.9142 \\\\ "
table7 <- c(table7[a <- 1:20], r2.vec, table7[-a])
table7 <- c(table7[a <- 1:21], n.line, table7[-a])
ll.vec =  "Log likelihood &  & -513.9239 &  \\\\ "
table7 <- c(table7[a <- 1:22], ll.vec, table7[-a])
aic.vec = "AIC &  & 54.29239 &  \\\\ "
table7 <- c(table7[a <- 1:23], aic.vec, table7[-a])
sc.vec = "SC &  & 55.7362 &  \\\\ "
table7 <- c(table7[a <- 1:24], sc.vec, table7[-a])
table7 <- c(table7[a <- 1:25], n.line, table7[-a])

```

```{r vec, eval=TRUE, echo=FALSE, tidy = TRUE, size="small", cache=FALSE, results="asis", message=F, warning=F}

cat(table7, sep='\n')
```

Además, es útil investigar la presencia de una relación de causalidad de Granger a corto y largo plazo entre las tres variables. La presencia de cointegración nos permite utilizar la representación de corrección de errores para investigar la relación de causalidad entre las variables. El Cuadro \ref{tab:tb7} proporciona los resultados estimados de la causalidad de Granger a través del modelo VEC que exhibe causalidad tanto a corto como a largo plazo.

El Cuadro \ref{tab:tb7} muestra el término de corrección de errores para la ecuación de cointegración con PIB, PIBMAN y XMIN como variables dependientes. En el Cuadro \ref{tab:tb7}, se destaca que existe una relación de causalidad en el sentido de Granger unidireccional entre las Exportaciones  Mineras Metálicas y el nivel de Producción Interna Bruta, también hay una relación de causalidad en el sentido de Granger unidireccional entre el PIB Manufacturero y el PIB, mientras que hay una relación de causalidad en el sentido de Granger en una dirección de las Exportaciones Mineras Metálicas hacia el PIB Manufacturero en las dos direcciones.

Los recursos minerales son materias primas para el sector industrial de la economía. Como resultado, actúa como una inversión de inventario en el proceso de producción industrial. La expansión del crecimiento económico requiere un mayor stock de capital y que a su vez requieren una mayor tasa de inversión en inventario en el sector industrial de la economía.


```{r displayGRANG, eval=TRUE, echo=FALSE, tidy = TRUE, size="small", cache=TRUE, results="hide", message=F, warning=F}
## WALT TEST SOLO PARA VECM?

##resultados obtenidos de eviews
grg.nam = c("DPBI", "", "DPBIMAN", "", "DXMIN", "")
pbi.all = c("-", 
            "", 
            0.321026,  ####
            "(0.8517)", ####
            1.297252, ###
            "(0.5228)") ###
pbiman.all = c( 6.989450, ###
            "(0.0304)", ###
                "-", 
                "",
            39.44536,
            "(0.0000)")
xmin.all = c(13.51599, ###
            "(0.0012)",###
            10.06200, ###
            "(0.0065)", ###
              "-", 
              "" )
resul.grg = c("DPBI \\leftarrow DPBIMAN, DPBI \\leftarrow DXMIN", "",  ##$\leftarrow DXMIN$
              "DPBIMAN \\leftarrow DXMIN","",
              "DXMIN \\leftarrow DPBIMAN","")
tab.gr = cbind(grg.nam, pbi.all, pbiman.all, xmin.all,resul.grg)

table8 = stargazer(tab.gr, 
                   label="tab:tb7",
                   type = "latex",
                   summary = FALSE, 
                   rownames = FALSE, 
                   header=FALSE,
                   digits = 2,
                   font.size="small",
                   title="Los resultados de la causalidad de Granger",
          notes = c("\\footnotesize{\\textit{Nota: $^{***}$ y $^{**}$} indica el nivel significativo al .01 y .05, respectivamente; el t estadistico de cada coeficiente}",
                    "\\footnotesize{ estimado está entre paréntesis; $\\leftarrow$ denota una causalidad unidireccional; $\\Delta$ denota primera diferencia.}",
                    "\\footnotesize{\\textit{Elaboración: Los autores}}"))


namesgrg <- c("\\\\[-1.8ex] VarDep &   &  &  &Causalidad\\\\",
              "\\\\[-1.8ex] & $\\Delta PBI$  &  $\\Delta PBIMAN$ & $\\Delta XMIN$ &\\\\")
table8 <- table8[c(-9)]
table8 <- c(table8[a <- 1:8], namesgrg, table8[-a])

cccgrg = "\\begin{tabular}{@{\\extracolsep{5pt}} lcccl} "
table8 <- table8[c(-6)]
table8 <- c(table8[a <- 1:5], cccgrg, table8[-a])

l1.grg = "$\\Delta$PBI & - & 6.98945$^{**}$ & 13.51599$^{***}$ & $\\Delta$PBI $\\leftarrow$ $\\Delta$PBIMAN, $\\Delta$PBI $\\leftarrow$XMIN \\\\ "
table8 <- table8[c(-12)]
table8 <- c(table8[a <- 1:11], l1.grg, table8[-a])

l2.grg = "$\\Delta$PBIMAN & 0.321026 & - & 10.062$^{***}$ & $\\Delta$PBIMAN $\\leftarrow$ $\\Delta$XMIN \\\\ "
table8 <- table8[c(-14)]
table8 <- c(table8[a <- 1:13], l2.grg, table8[-a])

l3.grg = "$\\Delta$XMIN & 1.297252 & 39.44536$^{***}$ & - & $\\Delta$XMIN $\\leftarrow$ $\\Delta$PBIMAN \\\\ "
table8 <- table8[c(-16)]
table8 <- c(table8[a <- 1:15], l3.grg, table8[-a])
```

```{r GRANG, eval=TRUE, echo=FALSE, tidy = TRUE, size="small", cache=FALSE, results="asis", message=F, warning=F}

cat(table8, sep='\n')
```

En nuestro análisis, hemos estimado el modelo, pero es necesario realizar una verificación de robustez del modelo. La eficacia del modelo ha sido probada para el supuesto de normalidad, heterocedasticidad y presencia de correlación serial como se observa en el Cuadro \ref{tab:tb5}. La distribución normal de los residuos se ha examinado en función del resultado del estadístico de Jarque-Bera . El resultado del diagnóstico sostiene que los residuos se distribuyen normalmente. Por lo tanto, nos movemos para probar la presencia de heteroscedasticidad en nuestro modelo basado en la prueba de heteroscedasticidad condicional autorregresiva (ARCH). El resultado no revela ningún efecto ARCH presente en el modelo que fortalezca los resultados estimados. Además, la presencia de correlación en serie en el modelo se ha verificado a través de la prueba de correlación en serie de Breusch-Godfrey, conocida alternativamente como prueba de multiplicador de Lagrange (LM). Se ha encontrado que no hay evidencia de correlación serial en el modelo. La lectura de los resultados de las pruebas anteriores fortalece los modelos estimados. 

```{r displaydiag, eval=TRUE, echo=FALSE, tidy = TRUE, size="small", cache=TRUE, results="hide", message=F, warning=F}
#https://cran.r-project.org/web/packages/MVN/vignettes/MVN.pdf
#normaldiad multivariada
norma.dh = mvn(dperu, mvnTest = "dh") ## dice no normaldiad multivariada

norm.test = normality.test(veclevel) #normalidad
    norm.jb = norm.test$jb.mul$JB
st = serial.test(veclevel, type = "BG") ##autocorrelación
arch.t = arch.test(veclevel) # heterocedasticidad

diag = c("Test J-B", "LM Autocorrelación", "Heterocedasticidad", "Estabilidad")
t.est = c(7.8761, 84.698, 90, "Raíces fuera del círculo unitario")
estb.p = c(0.2473, 0.9939, 1, "-")
tab.diag = cbind(diag, t.est, estb.p)
tab.diag = as.data.frame(tab.diag)
name.diag = c("Test de Diagnóstico", "Estadística", "p-valor")
tab.out6 = setNames(tab.diag, name.diag)
table5 = stargazer(tab.out6, 
                   label="tab:tb5",
                   summary = F,
                   header = F,
                   font.size="small",
           title="Resultados de las pruebas de diagnóstico del VEC(2)",
          notes = c("\\footnotesize{\\textit{Nota:} La Ho nula de J-B es la normalidad residual, la Ho es no autocorrelación, }",
                    " \\footnotesize{ la Ho de la prueba ARCH es heterocedasticidad, la estabilidad VEC revela que}",
                    " \\footnotesize{  5 raíces tienen un módulo menor que uno y se encuentran dentro del círculo de }",
                    "\\footnotesize{la unidad. }",
                    "\\footnotesize{\\textit{Elaboración: Los autores}}"))

cccestab = "\\begin{tabular}{@{\\extracolsep{5pt}} clcc} "   
table5 <- table5[c(-6)]
table5 <- c(table5[a <- 1:5], cccestab, table5[-a])
```

```{r diagn, eval=TRUE, echo=FALSE, tidy = TRUE, size="small", cache=FALSE, results="asis", message=F, warning=F}

cat(table5, sep='\n')
```

El modelo posee  tres raíces fuera del circulo unitario, por consiguiente, el modelo no es estable, lo cual afectaría la confiabilidad de la capacidad  predictiva del mismo, procedemos a calcular dicha predicción (imagen de las predicicones citar), y existe una divergencia entre los resultados del modelo y la evidencia empírica, se destaca el hecho que según el modelo, las exportaciones de minerales metálicos disminuirán en los años posteriores a los analizados, cuando en la realidad,  tuvieron un aumento significativo, según el Ministerio de Energía y Minas del Perú  y en el año 2017 representaron el 60% de todas las exportaciones, que sobrepasa el 55% que tuvieron en el 2016 [@MINEM2018].

\begin{figure}[h]
\centering
\includegraphics[width=0.7\textwidth,height=\textheight]{C:/Users/crist/Documents/eco2/trabajo_eco2/doc/figs/pred.pdf}
\caption{\label{fig:plot2} Previsión del modelo (En t+1)}
\end{figure}

# Conclusiones

Los resultados sugieren que las exportaciones mineras metálicas han sido determinantes para el crecimiento económico del Perú en el periodo 1994-2016. A pesar de que las divisas generadas por la exportación de minerales metálicos ayudan en gran medida lograr una mayor producción manufacturera, la orientación de inversiones hacia el sector minero pudieron haber ocasionado que el sector manufacturero no se expanda a un ritmo que le permita liderar el crecimiento económico.

Además, se concluyó que existió una relación de causalidad de las exportaciones mineras metálicas hacia el PBI, es decir, las exportaciones metálicas impulsaron el crecimiento económico del Perú. Esto respalda el equilibrio a largo plazo entre la minería metálica y el crecimiento económico peruano (Ecuación \ref{eq2} y \ref{eq3}). Asimismo, se evidenció una causalidad de la producción industrial hacia el PIB (Cuadro \ref{tab:tb7}).

La estrategia actual con la exportación de minerales como medio de ingresos de divisas no es viable ni justificable con respecto a lograr un desarrollo sostenible para la republica peruana. Los recursos minerales son de naturaleza agotable que no podrían reponerse dentro de un horizonte temporal económicamente factible. Por lo tanto, la extracción de minerales requiere un proceso de planificación sostenible así que el Gobierno del Perú debería tomar las medidas necesarias para extraer los recursos minerales sin comprometer el objetivo a largo plazo de la sostenibilidad.

\newpage

# Referencias
\setlength{\parindent}{-0.2in}
\setlength{\leftskip}{0.2in}
\setlength{\parskip}{8pt}
\vspace*{-0.2in}
\noindent
